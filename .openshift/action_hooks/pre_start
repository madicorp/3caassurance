#!/bin/bash

PYTHON=$VIRTUAL_ENV/bin/python
PIP=$VIRTUALENV_DIR/bin/pip

# Create database
sqlite3 "_3caassurance"

echo $OPENSHIFT_REPO_DIR > $VIRTUAL_ENV/.project

# Run migrate/update_index/load_initial_data
source $VIRTUAL_ENV/bin/activate
$PIP install --upgrade pip
$PIP install -r $PROJECT_DIR/requirements.txt
$PYTHON "$OPENSHIFT_REPO_DIR"manage.py migrate --noinput && \
$PYTHON "$OPENSHIFT_REPO_DIR"manage.py loaddata images _3caassurance && \
$PYTHON "$OPENSHIFT_REPO_DIR"manage.py update_index && \
$PYTHON "$OPENSHIFT_REPO_DIR"manage.py compilemessages -l fr
deactivate
